DROP TABLE IF EXISTS t1;
SET autocommit=0;
CREATE TABLE t1 (a INT) ENGINE=InnoDB;
SHOW VARIABLES LIKE 'trx%idle_timeout';
Variable_name	Value
trx_changes_idle_timeout	0
trx_idle_timeout	0
trx_readonly_idle_timeout	0
SELECT * FROM INFORMATION_SCHEMA.SESSION_VARIABLES WHERE VARIABLE_NAME LIKE 'trx%idle_timeout' order by VARIABLE_NAME;
VARIABLE_NAME	VARIABLE_VALUE
TRX_CHANGES_IDLE_TIMEOUT	0
TRX_IDLE_TIMEOUT	0
TRX_READONLY_IDLE_TIMEOUT	0
SET trx_idle_timeout=1;
SHOW VARIABLES LIKE 'trx%idle_timeout';
Variable_name	Value
trx_changes_idle_timeout	0
trx_idle_timeout	1
trx_readonly_idle_timeout	0
SELECT * FROM INFORMATION_SCHEMA.SESSION_VARIABLES WHERE VARIABLE_NAME LIKE 'trx%idle_timeout' order by VARIABLE_NAME;
VARIABLE_NAME	VARIABLE_VALUE
TRX_CHANGES_IDLE_TIMEOUT	0
TRX_IDLE_TIMEOUT	1
TRX_READONLY_IDLE_TIMEOUT	0
BEGIN;
INSERT INTO t1 VALUES (1),(2),(3);
COMMIT;
SELECT * FROM t1;
a
1
2
3
BEGIN;
INSERT INTO t1 VALUES (4),(5),(6);
SELECT * FROM t1;
ERROR HY000: MySQL server has gone away
SELECT * FROM t1;
a
1
2
3
DROP TABLE t1;
SET trx_idle_timeout=0;
SHOW VARIABLES LIKE 'trx%idle_timeout';
Variable_name	Value
trx_changes_idle_timeout	0
trx_idle_timeout	0
trx_readonly_idle_timeout	0
SELECT * FROM INFORMATION_SCHEMA.SESSION_VARIABLES WHERE VARIABLE_NAME LIKE 'trx%idle_timeout' order by VARIABLE_NAME;
VARIABLE_NAME	VARIABLE_VALUE
TRX_CHANGES_IDLE_TIMEOUT	0
TRX_IDLE_TIMEOUT	0
TRX_READONLY_IDLE_TIMEOUT	0
DROP TABLE IF EXISTS t1;
SET autocommit=0;
CREATE TABLE t1 (a INT) ENGINE=InnoDB;
SHOW VARIABLES LIKE 'trx%idle_timeout';
Variable_name	Value
trx_changes_idle_timeout	0
trx_idle_timeout	0
trx_readonly_idle_timeout	0
SELECT * FROM INFORMATION_SCHEMA.SESSION_VARIABLES WHERE VARIABLE_NAME LIKE 'trx%idle_timeout' order by VARIABLE_NAME;
VARIABLE_NAME	VARIABLE_VALUE
TRX_CHANGES_IDLE_TIMEOUT	0
TRX_IDLE_TIMEOUT	0
TRX_READONLY_IDLE_TIMEOUT	0
SET trx_readonly_idle_timeout=1;
SHOW VARIABLES LIKE 'trx%idle_timeout';
Variable_name	Value
trx_changes_idle_timeout	0
trx_idle_timeout	0
trx_readonly_idle_timeout	1
SELECT * FROM INFORMATION_SCHEMA.SESSION_VARIABLES WHERE VARIABLE_NAME LIKE 'trx%idle_timeout' order by VARIABLE_NAME;
VARIABLE_NAME	VARIABLE_VALUE
TRX_CHANGES_IDLE_TIMEOUT	0
TRX_IDLE_TIMEOUT	0
TRX_READONLY_IDLE_TIMEOUT	1
BEGIN;
INSERT INTO t1 VALUES (1),(2),(3);
SELECT * FROM t1;
a
1
2
3
COMMIT;
SELECT * FROM t1;
a
1
2
3
SELECT * FROM t1;
ERROR HY000: MySQL server has gone away
SELECT * FROM t1;
a
1
2
3
DROP TABLE t1;
SET trx_readonly_idle_timeout=0;
SHOW VARIABLES LIKE 'trx%idle_timeout';
Variable_name	Value
trx_changes_idle_timeout	0
trx_idle_timeout	0
trx_readonly_idle_timeout	0
SELECT * FROM INFORMATION_SCHEMA.SESSION_VARIABLES WHERE VARIABLE_NAME LIKE 'trx%idle_timeout' order by VARIABLE_NAME;
VARIABLE_NAME	VARIABLE_VALUE
TRX_CHANGES_IDLE_TIMEOUT	0
TRX_IDLE_TIMEOUT	0
TRX_READONLY_IDLE_TIMEOUT	0
DROP TABLE IF EXISTS t1;
SET autocommit=0;
CREATE TABLE t1 (a INT) ENGINE=InnoDB;
SHOW VARIABLES LIKE 'trx%idle_timeout';
Variable_name	Value
trx_changes_idle_timeout	0
trx_idle_timeout	0
trx_readonly_idle_timeout	0
SELECT * FROM INFORMATION_SCHEMA.SESSION_VARIABLES WHERE VARIABLE_NAME LIKE 'trx%idle_timeout' order by VARIABLE_NAME;
VARIABLE_NAME	VARIABLE_VALUE
TRX_CHANGES_IDLE_TIMEOUT	0
TRX_IDLE_TIMEOUT	0
TRX_READONLY_IDLE_TIMEOUT	0
SET trx_changes_idle_timeout=1;
SHOW VARIABLES LIKE 'trx%idle_timeout';
Variable_name	Value
trx_changes_idle_timeout	1
trx_idle_timeout	0
trx_readonly_idle_timeout	0
SELECT * FROM INFORMATION_SCHEMA.SESSION_VARIABLES WHERE VARIABLE_NAME LIKE 'trx%idle_timeout' order by VARIABLE_NAME;
VARIABLE_NAME	VARIABLE_VALUE
TRX_CHANGES_IDLE_TIMEOUT	1
TRX_IDLE_TIMEOUT	0
TRX_READONLY_IDLE_TIMEOUT	0
BEGIN;
INSERT INTO t1 VALUES (1),(2),(3);
SELECT * FROM t1;
a
1
2
3
COMMIT;
SELECT * FROM t1;
a
1
2
3
SELECT * FROM t1;
a
1
2
3
INSERT INTO t1 VALUES (4),(5),(6);
SELECT * FROM t1;
ERROR HY000: MySQL server has gone away
DROP TABLE t1;
SET trx_changes_idle_timeout=0;
SHOW VARIABLES LIKE 'trx%idle_timeout';
Variable_name	Value
trx_changes_idle_timeout	0
trx_idle_timeout	0
trx_readonly_idle_timeout	0
SELECT * FROM INFORMATION_SCHEMA.SESSION_VARIABLES WHERE VARIABLE_NAME LIKE 'trx%idle_timeout' order by VARIABLE_NAME;
VARIABLE_NAME	VARIABLE_VALUE
TRX_CHANGES_IDLE_TIMEOUT	0
TRX_IDLE_TIMEOUT	0
TRX_READONLY_IDLE_TIMEOUT	0
